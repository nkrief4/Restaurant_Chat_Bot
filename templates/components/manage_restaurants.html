<section id="manage-restaurants" class="section" aria-label="Créer ou modifier un restaurant">
    <div class="section-header">
        <div>
            <h2>Gérer vos restaurants</h2>
            <p>Créez un nouvel établissement ou mettez à jour une fiche existante depuis le même écran.</p>
        </div>
    </div>

    <div class="restaurant-management" data-restaurant-tabs>
        <div class="restaurant-tabs" role="tablist" aria-label="Choisir le mode de gestion">
            <button type="button" class="restaurant-tab is-active" role="tab" aria-selected="true" tabindex="0"
                id="restaurant-tab-edit" aria-controls="restaurant-panel-edit" data-restaurant-tab="edit">
                Modification
            </button>
            <button type="button" class="restaurant-tab" role="tab" aria-selected="false" tabindex="-1"
                id="restaurant-tab-create" aria-controls="restaurant-panel-create" data-restaurant-tab="create">
                Création
            </button>
            <span class="restaurant-tab-indicator" data-tab-indicator aria-hidden="true"></span>
        </div>

        <div class="restaurant-panels" data-active-tab="edit">
            <div class="restaurant-panel-track">
                <div class="restaurant-panel" id="restaurant-panel-create" role="tabpanel"
                    aria-labelledby="restaurant-tab-create" aria-hidden="true" data-tab-panel="create">
                    <form class="restaurant-form" id="restaurant-create-form" data-form-type="create" novalidate>
                        <p class="form-mode" data-role="form-mode">Création d'un nouvel établissement.</p>
                        <div class="restaurant-form-layout single-column">
                            <div class="restaurant-form-main">
                                <div class="restaurant-form-heading">
                                    <p class="eyebrow">Profil</p>
                                    <h3>Informations principales</h3>
                                    <p class="muted">Ces données alimentent la fiche publique et vos cartes.</p>
                                </div>
                                <div class="form-grid compact-grid">
                                    <label>
                                        <span>Nom du restaurant</span>
                                        <input type="text" name="display_name" placeholder="Ex : Le Jardin Secret"
                                            required />
                                    </label>
                                    <label>
                                        <span>Slug public</span>
                                        <input type="text" name="slug" placeholder="lejardin-secret" required />
                                    </label>
                                    <label>
                                        <span>Langue principale</span>
                                        <select disabled>
                                            <option>Français</option>
                                        </select>
                                    </label>
                                    <label>
                                        <span>Site web (optionnel)</span>
                                        <input type="url" placeholder="https://monsite.com" disabled />
                                    </label>
                                </div>
                            </div>

                            <div class="menu-editor-wrapper" data-role="menu-editor-wrapper">
                                <div class="menu-editor-toolbar">
                                    <h3>Menu structuré</h3>
                                    <div class="menu-editor-mode-toggle">
                                        <button type="button" class="mode-btn active" data-mode="visual">
                                            Visuel
                                        </button>
                                        <button type="button" class="mode-btn" data-mode="json">
                                            JSON
                                        </button>
                                    </div>
                                </div>

                                <!-- Visual Editor -->
                                <div class="menu-editor-visual" data-role="menu-visual-editor">
                                    <!-- Categories will be rendered here by MenuEditor -->
                                </div>

                                <!-- JSON Editor (hidden by default) -->
                                <div class="menu-editor-json" data-role="menu-json-editor" hidden>
                                    <textarea rows="12" name="menu_document"
                                        placeholder='{"categories": []}'></textarea>
                                </div>
                            </div>

                            <div class="upload-card">
                                <div class="upload-card-header">
                                    <div>
                                        <h3>Analyser des fichiers menu</h3>
                                        <p class="muted">Importez jusqu'à 5 images ou PDFs, RestauBot les
                                            structurera
                                            automatiquement.</p>
                                    </div>
                                </div>
                                <label class="upload-dropzone" data-role="menu-dropzone">
                                    <input type="file" data-role="menu-file" accept="application/pdf,image/*" multiple
                                        aria-label="Sélectionner des menus à analyser" />
                                    <div class="dropzone-illustration" aria-hidden="true"></div>
                                    <div class="dropzone-copy">
                                        <strong>Glissez-déposez vos images de menu</strong>
                                        <span>ou cliquez pour parcourir vos fichiers</span>
                                        <small>10 Mo par fichier · Max 5 images · Formats PDF / image</small>
                                    </div>
                                </label>
                                <div class="upload-files-gallery" data-role="files-gallery">
                                    <!-- Files will be displayed here dynamically -->
                                </div>
                                <div class="upload-controls">
                                    <button type="button" class="secondary-btn ai-upload-btn" data-action="upload-menu">
                                        <span class="ai-btn-label" data-role="ai-btn-label">Analyser avec
                                            l'IA</span>
                                        <span class="ai-glow" aria-hidden="true"></span>
                                        <span class="ai-scanlines" aria-hidden="true"></span>
                                    </button>
                                </div>
                                <p class="form-hint" data-role="menu-upload-status"></p>
                            </div>
                        </div>
                        <div class="form-footer sticky-footer">
                            <div class="footer-content">
                                <div class="footer-actions">
                                    <button type="submit" class="primary-btn" data-role="submit-btn">Enregistrer le
                                        restaurant</button>
                                    <button type="button" class="ghost-btn" data-action="reset-form">Réinitialiser le
                                        formulaire</button>
                                </div>
                                <p class="form-hint" data-role="form-message"></p>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="restaurant-panel" id="restaurant-panel-edit" role="tabpanel"
                    aria-labelledby="restaurant-tab-edit" data-tab-panel="edit">
                    <div class="panel-intro">
                        <p class="form-mode" data-role="form-mode">Aucun restaurant sélectionné pour édition.</p>
                        <!-- Local selector removed, relying on global selector -->
                        <p class="form-hint">Utilisez le sélecteur global en haut de page pour choisir l'établissement à
                            modifier.</p>
                    </div>

                    <form class="restaurant-form is-idle" id="restaurant-edit-form" data-form-type="edit" novalidate>
                        <div class="restaurant-form-layout single-column">
                            <div class="restaurant-form-main">
                                <div class="restaurant-form-heading">
                                    <p class="eyebrow">Fiche</p>
                                    <h3>Détails de l'établissement</h3>
                                    <p class="muted">Les champs sont préremplis après sélection d'un restaurant.</p>
                                </div>
                                <div class="form-grid compact-grid">
                                    <label>
                                        <span>Nom du restaurant</span>
                                        <input type="text" name="display_name" placeholder="Ex : Le Jardin Secret"
                                            required />
                                    </label>
                                    <label>
                                        <span>Slug public</span>
                                        <input type="text" name="slug" placeholder="lejardin-secret" required />
                                    </label>
                                    <label>
                                        <span>Langue principale</span>
                                        <select disabled>
                                            <option>Français</option>
                                        </select>
                                    </label>
                                    <label>
                                        <span>Site web (optionnel)</span>
                                        <input type="url" placeholder="https://monsite.com" disabled />
                                    </label>
                                </div>
                            </div>

                            <div class="menu-editor-wrapper" data-role="menu-editor-wrapper">
                                <div class="menu-editor-toolbar">
                                    <h3>Menu structuré</h3>
                                    <div class="menu-editor-mode-toggle">
                                        <button type="button" class="mode-btn active" data-mode="visual">
                                            Visuel
                                        </button>
                                        <button type="button" class="mode-btn" data-mode="json">
                                            JSON
                                        </button>
                                    </div>
                                </div>

                                <!-- Visual Editor -->
                                <div class="menu-editor-visual" data-role="menu-visual-editor">
                                    <!-- Categories will be rendered here by MenuEditor -->
                                </div>

                                <!-- JSON Editor (hidden by default) -->
                                <div class="menu-editor-json" data-role="menu-json-editor" hidden>
                                    <textarea rows="12" name="menu_document"
                                        placeholder='{"categories": []}'></textarea>
                                </div>
                            </div>

                            <div class="upload-card">
                                <div class="upload-card-header">
                                    <div>
                                        <h3>Analyser des fichiers menu</h3>
                                        <p class="muted">Importez jusqu'à 5 images ou PDFs, RestauBot les structurera
                                            automatiquement.</p>
                                    </div>
                                </div>
                                <label class="upload-dropzone" data-role="menu-dropzone">
                                    <input type="file" data-role="menu-file" accept="application/pdf,image/*" multiple
                                        aria-label="Sélectionner des menus à analyser" />
                                    <div class="dropzone-illustration" aria-hidden="true"></div>
                                    <div class="dropzone-copy">
                                        <strong>Glissez-déposez vos images de menu</strong>
                                        <span>ou cliquez pour parcourir vos fichiers</span>
                                        <small>10 Mo par fichier · Max 5 images · Formats PDF / image</small>
                                    </div>
                                </label>
                                <div class="upload-files-gallery" data-role="files-gallery">
                                    <!-- Files will be displayed here dynamically -->
                                </div>
                                <div class="upload-controls">
                                    <button type="button" class="secondary-btn ai-upload-btn" data-action="upload-menu">
                                        <span class="ai-btn-label" data-role="ai-btn-label">Analyser avec l'IA</span>
                                        <span class="ai-glow" aria-hidden="true"></span>
                                        <span class="ai-scanlines" aria-hidden="true"></span>
                                    </button>
                                </div>
                                <p class="form-hint" data-role="menu-upload-status"></p>
                            </div>
                        </div>

                        <div class="form-footer sticky-footer">
                            <div class="footer-content">
                                <div class="footer-actions">
                                    <button type="submit" class="primary-btn" data-role="submit-btn">Mettre à jour le
                                        restaurant</button>
                                    <button type="button" class="ghost-btn" data-action="reset-form">Terminer
                                        l'édition</button>
                                </div>
                                <p class="form-hint" data-role="form-message"></p>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</section>